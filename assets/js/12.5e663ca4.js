(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{163:function(t,s,n){"use strict";n.r(s);var a=n(0),e=Object(a.a)({},function(){var t=this,s=t.$createElement,n=t._self._c||s;return n("div",{staticClass:"content"},[t._m(0),t._v(" "),t._m(1),t._v(" "),n("p",[t._v("``")]),t._v(" "),t._m(2),t._v(" "),t._m(3),t._v(" "),t._m(4),t._v(" "),t._m(5),t._v(" "),t._m(6),t._v(" "),t._m(7),t._v(" "),t._m(8),t._v(" "),t._m(9),t._v(" "),t._m(10),t._v(" "),t._m(11),t._v(" "),t._m(12),t._v(" "),t._m(13),t._v(" "),t._m(14),t._v(" "),t._m(15),t._v(" "),t._m(16),t._v(" "),t._m(17),t._v(" "),t._m(18),t._v(" "),t._m(19),t._v(" "),t._m(20),t._v(" "),n("div",{staticClass:"tip custom-block"},[n("p",{staticClass:"custom-block-title"},[t._v("TIP")]),t._v(" "),n("p",[n("a",{attrs:{href:"https://blog.csdn.net/ky1in93/article/details/81362442",target:"_blank",rel:"noopener noreferrer"}},[t._v("原文地址"),n("OutboundLink")],1)]),t._v(" "),t._m(21),t._v(" "),n("hr"),t._v(" "),t._m(22)]),t._v(" "),t._m(23),t._v(" "),t._m(24),t._v(" "),t._m(25),t._v(" "),t._m(26),t._v(" "),t._m(27),t._v(" "),n("p",[t._v("componentWillReceiveProps\nshouldComponentUpdate\ncomponentWillUpdate\nrender\ncomponentDidUpdate\n")]),t._v(" "),n("img",{attrs:{src:t.$withBase("/react/reactcycle.png")}}),t._v("\n### `componentWillReceiveProps` \n::: warning 没改比props也会触发\n- 只要是在父组件render函数调用，render里的子组件就会经历更新的过程，不管父组件传递给子组建的props有没有改变，都会触发子组件的componentWillReaciveProps\n- this.setState 不会调用componentWillReaciveProps\n:::\n- 参数\n    - nextProps\n    - nextState\n"),t._m(28),t._v(" "),t._m(29),t._v(" "),t._m(30),t._v(" "),t._m(31),t._v(" "),t._m(32),t._m(33),n("img",{attrs:{src:t.$withBase("/react/reactWenti1.gif")}}),t._v("\n![](/react/reactWenti1.gif)\n"),t._m(34),t._v(" "),t._m(35),t._v(" "),t._m(36),t._v(" "),t._m(37),t._v(" "),t._m(38),t._v(" "),t._m(39),t._v(" "),t._m(40),t._v(" "),t._m(41),t._v(" "),t._m(42),t._v(" "),t._m(43),t._v(" "),t._m(44)])},[function(){var t=this.$createElement,s=this._self._c||t;return s("h1",{attrs:{id:"第二章"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#第二章","aria-hidden":"true"}},[this._v("#")]),this._v(" 第二章")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"设计高质量的react组件"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#设计高质量的react组件","aria-hidden":"true"}},[this._v("#")]),this._v(" 设计高质量的React组件")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"易于维护的组件设计要素"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#易于维护的组件设计要素","aria-hidden":"true"}},[this._v("#")]),this._v(" 易于维护的组件设计要素")])},function(){var t=this,s=t.$createElement,n=t._self._c||s;return n("ul",[n("li",[n("code",[t._v("分而治之")]),t._v("拆分为单个功能的组件\n"),n("ul",[n("li",[t._v("确定组件的边界\n"),n("ul",[n("li",[t._v("根据功能划分模块")])])]),t._v(" "),n("li",[t._v("高内聚、低耦合 todo (深层次的理解)\n"),n("ul",[n("li",[t._v("高内聚 把逻辑紧密相关的内容放在一个组件中。")]),t._v(" "),n("li",[t._v("不同组件的关系尽量要弱化。")])])])])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"react组件的数据"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#react组件的数据","aria-hidden":"true"}},[this._v("#")]),this._v(" React组件的数据")])},function(){var t=this.$createElement,s=this._self._c||t;return s("ul",[s("li",[s("code",[this._v("props")]),this._v(" 对外接口")]),this._v(" "),s("li",[s("code",[this._v("state")]),this._v(" 内部状态")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"区别"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#区别","aria-hidden":"true"}},[this._v("#")]),this._v(" 区别")])},function(){var t=this.$createElement,s=this._self._c||t;return s("ul",[s("li",[this._v("props用于定义外部接口，state用于记录内部状态")]),this._v(" "),s("li",[this._v("props的赋值在外部使用，state在内部使用")]),this._v(" "),s("li",[this._v("组件内部不能改变state，只能通过state让组件来改变的")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("升级版的 "),s("code",[this._v("2.2.1")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"danger custom-block"},[s("p",{staticClass:"custom-block-title"},[this._v("react的类型检查PropTypes自React v15.5起已弃用，请使用prop-types")]),this._v(" "),s("p",[this._v("import PropTypes from 'prop-types';")]),this._v(" "),s("pre",[s("code",[this._v("        p小写\n")])]),this._v(" "),s("p",[this._v("MyComponent.propTypes = {\n// 你可以将属性声明为以下 JS 原生类型\noptionalArray: PropTypes.array,\nP大写")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"共同原则"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#共同原则","aria-hidden":"true"}},[this._v("#")]),this._v(" 共同原则")])},function(){var t=this.$createElement,s=this._self._c||t;return s("ul",[s("li",[this._v("都会引起组件的重新渲染")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"组件的生命周期"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#组件的生命周期","aria-hidden":"true"}},[this._v("#")]),this._v(" 组件的生命周期")])},function(){var t=this.$createElement,s=this._self._c||t;return s("ul",[s("li",[this._v("阶段划分\n"),s("ul",[s("li",[this._v("装载阶段")]),this._v(" "),s("li",[this._v("更新阶段")]),this._v(" "),s("li",[this._v("卸载阶段")])])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"装载阶段"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#装载阶段","aria-hidden":"true"}},[this._v("#")]),this._v(" 装载阶段")])},function(){var t=this,s=t.$createElement,n=t._self._c||s;return n("ol",[n("li",[n("strong",[n("code",[t._v("constructor")]),t._v(" 唯一会在服务端调用的函数")]),t._v(" "),n("ul",[n("li",[t._v("形参\n"),n("ul",[n("li",[t._v("props")]),t._v(" "),n("li",[t._v("context ？ 不知道是啥")])])])])]),t._v(" "),n("li",[n("strong",[n("code",[t._v("componentWillMount")])]),t._v(" "),n("code",[t._v("即将废弃")])]),t._v(" "),n("li",[n("strong",[n("code",[t._v("render")]),t._v(" 最重要的函数 -> 返回dom结构。必须纯函数")])]),t._v(" "),n("li",[n("strong",[n("code",[t._v("componentDidMount")])])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("ul",[s("li",[this._v("render执行后不会立即执行。在render后执行")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h5",{attrs:{id:"问题？"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#问题？","aria-hidden":"true"}},[this._v("#")]),this._v(" 问题？")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("为什么推荐在"),s("code",[this._v("componentDidMount中请求参数")]),this._v("？")])},function(){var t=this.$createElement,s=this._self._c||t;return s("ul",[s("li",[s("p",[this._v("componentWillMount方法的调用在constructor之后，在render之前，在这方法里的代码调用setState方法不会触发重渲染，所以它一般不会用来作加载数据之用，它也很少被使用到。")])]),this._v(" "),s("li",[s("p",[this._v("一般的从后台(服务器)获取的数据，都会与组件上要用的数据加载有关，所以都在componentDidMount方法里面作。虽然与组件上的数据无关的加载，也可以在constructor里作，但constructor是作组件state初绐化工作，并不是设计来作加载数据这工作的，所以所有有副作用的代码都会集中在componentDidMount方法里。")])]),this._v(" "),s("li",[s("p",[this._v("constructor()中获取数据的话，如果时间太长，或者出错，组件就渲染不出来，你整个页面都没法渲染了。")])]),this._v(" "),s("li",[s("p",[this._v("componentDidMount()中能保证你的组件已经正确渲染。")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h4",{attrs:{id:"总结下："}},[s("a",{staticClass:"header-anchor",attrs:{href:"#总结下：","aria-hidden":"true"}},[this._v("#")]),this._v(" 总结下：")])},function(){var t=this.$createElement,s=this._self._c||t;return s("ul",[s("li",[this._v("作者：嘴强王者菜月昴")]),this._v(" "),s("li",[this._v("来源：CSDN")])])},function(){var t=this,s=t.$createElement,n=t._self._c||s;return n("ul",[n("li",[n("p",[t._v("constructor()")]),t._v(" "),n("ul",[n("li",[n("p",[t._v("constructor()中获取数据的话，如果时间太长，或者出错，组件就渲染不出来，整个页面都没法渲染了。")])]),t._v(" "),n("li",[n("p",[t._v("constructor是作组件state初绐化工作，并不是设计来作加载数据的。")])])])]),t._v(" "),n("li",[n("p",[t._v("componentWillMount()")]),t._v(" "),n("ul",[n("li",[n("p",[t._v("如果使用SSR（服务端渲染）,componentWillMount会执行2次，一次在服务端，一次在客户端。而componentDidMount不会。")])]),t._v(" "),n("li",[n("p",[t._v("constructor可以完成state初始化，componentWillMount使用的很少，目前16版本加入了UNSAFE来标识componentWillMount，新的生命周期static getDerivedStateFromProps()   也会替代这个。")])]),t._v(" "),n("li",[n("p",[t._v("React16之后采用了Fiber架构，只有componentDidMount声明周期函数是确定被执行一次的，类似ComponentWillMount的生命周期钩子都有可能执行多次，所以不加以在这些生命周期中做有副作用的操作，比如请求数据之类。")])])])]),t._v(" "),n("li",[n("p",[t._v("render()")]),t._v(" "),n("ul",[n("li",[t._v("无限render")])])]),t._v(" "),n("li",[n("p",[t._v("componentDidMount()")]),t._v(" "),n("ul",[n("li",[n("p",[t._v('确保已经render过一次。提醒我们正确地设置初始状态，这样就不会得到导致错误的"undefined"状态。')])]),t._v(" "),n("li",[n("p",[t._v("componentDidMount方法中的代码，是在组件已经完全挂载到网页上才会调用被执行，所以可以保证数据的加载。此外，在这方法中调用setState方法，会触发重渲染。所以，官方设计这个方法就是用来加载外部数据用的，或处理其他的副作用代码。")])])])])])},function(){var t=this,s=t.$createElement,n=t._self._c||s;return n("ol",[n("li",[n("p",[t._v("跟服务器端渲染（同构）有关系，如果在componentWillMount里面获取数据，fetch data会执行两次，一次在服务器端一次在客户端。在componentDidMount中可以解决这个问题。")])]),t._v(" "),n("li",[n("p",[t._v("在componentWillMount中fetch数据一定在render后才能到达，如果你忘记了设置初始状态，用户体验不好。")])]),t._v(" "),n("li",[n("p",[t._v("react16.0以后，componentWillMount可能会被执行多次。"),n("code",[t._v("服务端")]),t._v("、"),n("code",[t._v("客户端")])])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h4",{attrs:{id:"多个组件嵌套的生命周期函数装在执行顺序"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#多个组件嵌套的生命周期函数装在执行顺序","aria-hidden":"true"}},[this._v("#")]),this._v(" 多个组件嵌套的生命周期函数装在执行顺序")])},function(){var t=this,s=t.$createElement,n=t._self._c||s;return n("div",{staticClass:"tip custom-block"},[n("p",{staticClass:"custom-block-title"},[t._v("TIP")]),t._v(" "),n("ul",[n("li",[t._v('{count: 1} {} "第一个生命周期函数"')]),t._v(" "),n("li",[t._v("componentWillMount app")]),t._v(" "),n("li",[t._v("render")]),t._v(" "),n("li",[t._v("constructorcount count")]),t._v(" "),n("li",[t._v("componentWillMount count")]),t._v(" "),n("li",[t._v("render CountApp")]),t._v(" "),n("li",[t._v("constructorcount countApp")]),t._v(" "),n("li",[t._v("componentWillMount CountApp")]),t._v(" "),n("li",[t._v("render CountApp")]),t._v(" "),n("li",[t._v("componentDidMount count")]),t._v(" "),n("li",[t._v("componentDidMount CountApp")]),t._v(" "),n("li",[t._v("componentDidMount app")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"warning custom-block"},[s("p",{staticClass:"custom-block-title"},[this._v("总结 `componentDidMount`只在客户端执行")]),this._v(" "),s("ul",[s("li",[this._v("componentWillMount与render紧密相连")]),this._v(" "),s("li",[this._v("render本身不会渲染页面，只会返回")]),this._v(" "),s("li",[this._v("当组件内部的所有render都调用完，才会依次执行所有的componenttDidMount")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"更新过程"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#更新过程","aria-hidden":"true"}},[this._v("#")]),this._v(" 更新过程")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"废除的属性-只在-createclass-中调用"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#废除的属性-只在-createclass-中调用","aria-hidden":"true"}},[this._v("#")]),this._v(" 废除的属性 只在 createClass 中调用")])},function(){var t=this.$createElement,s=this._self._c||t;return s("ul",[s("li",[this._v("getInitialState\n"),s("ul",[s("li",[this._v("getInitialState was defined on App, a plain JavaScript class. This is only supported for classes created using React.createClass. Did you mean to define a state property instead?")])])]),this._v(" "),s("li",[this._v("getDefaultProps\n"),s("ul",[s("li",[this._v("getDefaultProps was defined on App, a plain JavaScript class. This is only supported for classes created using React.createClass. Use a static property to define defaultProps instead.")])])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"组件向外传递数据"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#组件向外传递数据","aria-hidden":"true"}},[this._v("#")]),this._v(" 组件向外传递数据")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"问题"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#问题","aria-hidden":"true"}},[this._v("#")]),this._v(" 问题")])},function(){var t=this,s=t.$createElement,n=t._self._c||s;return n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{attrs:{class:"token comment"}},[t._v("/**\n * @author z\n * @file\n */")]),t._v("\n"),n("span",{attrs:{class:"token keyword"}},[t._v("import")]),t._v(" React"),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" Component"),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" h "),n("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),n("span",{attrs:{class:"token string"}},[t._v("'react'")]),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),n("span",{attrs:{class:"token keyword"}},[t._v("import")]),t._v(" Count "),n("span",{attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),n("span",{attrs:{class:"token string"}},[t._v("'./count'")]),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{attrs:{class:"token keyword"}},[t._v("import")]),t._v(" CountApp "),n("span",{attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),n("span",{attrs:{class:"token string"}},[t._v("'./countApp'")]),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n\n\n\n"),n("span",{attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("default")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),n("span",{attrs:{class:"token class-name"}},[t._v("App")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("extends")]),t._v(" "),n("span",{attrs:{class:"token class-name"}},[t._v("Component")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),n("span",{attrs:{class:"token function"}},[t._v("constructor")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("props"),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" context"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{attrs:{class:"token keyword"}},[t._v("super")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("props"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),n("span",{attrs:{class:"token keyword"}},[t._v("this")]),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("state "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      defaultVal"),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{attrs:{class:"token number"}},[t._v("2")]),t._v("\n    "),n("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),n("span",{attrs:{class:"token keyword"}},[t._v("this")]),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("eventClickSetVal "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("this")]),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("eventClickSetVal"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{attrs:{class:"token function"}},[t._v("bind")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token keyword"}},[t._v("this")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),n("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n\n  "),n("span",{attrs:{class:"token function"}},[t._v("componentWillReceiveProps")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    console"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{attrs:{class:"token function"}},[t._v("log")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token string"}},[t._v("'父组件=》componentWillReceiveProps'")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),n("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),n("span",{attrs:{class:"token function"}},[t._v("shouldComponentUpdate")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    console"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{attrs:{class:"token function"}},[t._v("log")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token string"}},[t._v("'父组件=》shouldComponentUpdate'")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),n("span",{attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),n("span",{attrs:{class:"token boolean"}},[t._v("true")]),t._v("\n\n  "),n("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n  "),n("span",{attrs:{class:"token function"}},[t._v("eventClickSetVal")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    console"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{attrs:{class:"token function"}},[t._v("log")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token keyword"}},[t._v("this")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),n("span",{attrs:{class:"token keyword"}},[t._v("this")]),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{attrs:{class:"token function"}},[t._v("setState")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      defaultVal"),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{attrs:{class:"token number"}},[t._v("10")]),t._v("\n    "),n("span",{attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),n("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n  "),n("span",{attrs:{class:"token function"}},[t._v("render")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    console"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{attrs:{class:"token function"}},[t._v("log")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token string"}},[t._v("'父组件的render'")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),n("span",{attrs:{class:"token keyword"}},[t._v("return")]),t._v(" h"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{attrs:{class:"token function"}},[t._v("div")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token punctuation"}},[t._v("{")]),n("span",{attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      h"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{attrs:{class:"token function"}},[t._v("h1")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token punctuation"}},[t._v("{")]),n("span",{attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{attrs:{class:"token string"}},[t._v("'count'")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n\n      "),n("span",{attrs:{class:"token comment"}},[t._v("// h(Count, {}, ''),")]),t._v("\n      "),n("span",{attrs:{class:"token function"}},[t._v("h")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token string"}},[t._v("'h1'")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("{")]),n("span",{attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("this")]),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("state"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("defaultVal"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      "),n("span",{attrs:{class:"token function"}},[t._v("h")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("CountApp"),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" count"),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("this")]),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("state"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("defaultVal "),n("span",{attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{attrs:{class:"token string"}},[t._v("''")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      \n      "),n("span",{attrs:{class:"token function"}},[t._v("h")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token string"}},[t._v("'button'")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        onClick"),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("this")]),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("eventClickSetVal\n      "),n("span",{attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{attrs:{class:"token string"}},[t._v("'改变初始值'")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),n("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n\n")])])])},function(){var t=this,s=t.$createElement,n=t._self._c||s;return n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("default")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),n("span",{attrs:{class:"token class-name"}},[t._v("Count")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("extends")]),t._v(" "),n("span",{attrs:{class:"token class-name"}},[t._v("Component")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),n("span",{attrs:{class:"token function"}},[t._v("constructor")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("props"),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" context"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{attrs:{class:"token keyword"}},[t._v("super")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("props"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n   \n    "),n("span",{attrs:{class:"token keyword"}},[t._v("this")]),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("state "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      count"),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("this")]),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("props"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("count \n    "),n("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),n("span",{attrs:{class:"token keyword"}},[t._v("this")]),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("onClickButton "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("this")]),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("onClickButton"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{attrs:{class:"token function"}},[t._v("bind")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token keyword"}},[t._v("this")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),n("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),n("span",{attrs:{class:"token comment"}},[t._v("//   static defaultProps.count = 0/")]),t._v("\n"),n("span",{attrs:{class:"token keyword"}},[t._v("static")]),t._v(" defaultProps "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    count"),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{attrs:{class:"token number"}},[t._v("1000")]),t._v("\n"),n("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{attrs:{class:"token function"}},[t._v("componentWillReceiveProps")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  console"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{attrs:{class:"token function"}},[t._v("log")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token string"}},[t._v("'count组件=》componentWillReceiveProps'")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{attrs:{class:"token function"}},[t._v("shouldComponentUpdate")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  console"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{attrs:{class:"token function"}},[t._v("log")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token string"}},[t._v("'count组件=》shouldComponentUpdate'")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),n("span",{attrs:{class:"token keyword"}},[t._v("return")]),t._v(" felse\n\n"),n("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),n("span",{attrs:{class:"token comment"}},[t._v("// methods")]),t._v("\n  "),n("span",{attrs:{class:"token function"}},[t._v("onClickButton")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("e"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{attrs:{class:"token keyword"}},[t._v("this")]),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{attrs:{class:"token function"}},[t._v("setState")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("count"),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{attrs:{class:"token operator"}},[t._v("++")]),n("span",{attrs:{class:"token keyword"}},[t._v("this")]),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("state"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("count"),n("span",{attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),n("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),n("span",{attrs:{class:"token function"}},[t._v("render")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    console"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{attrs:{class:"token function"}},[t._v("log")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token string"}},[t._v("'子组件的render'")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),n("span",{attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n    h"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{attrs:{class:"token function"}},[t._v("div")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token string"}},[t._v("''")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("{")]),n("span",{attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    h"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{attrs:{class:"token function"}},[t._v("p")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token punctuation"}},[t._v("{")]),n("span",{attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{attrs:{class:"token string"}},[t._v("'state的值count: '")]),t._v(" "),n("span",{attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("this")]),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("state"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("count"),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{attrs:{class:"token string"}},[t._v("''")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    h"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{attrs:{class:"token function"}},[t._v("p")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token punctuation"}},[t._v("{")]),n("span",{attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{attrs:{class:"token string"}},[t._v("'props的值count: '")]),t._v(" "),n("span",{attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("this")]),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("props"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("count"),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{attrs:{class:"token string"}},[t._v("''")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n\n        h"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{attrs:{class:"token function"}},[t._v("button")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("onClick"),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("e"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("this")]),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{attrs:{class:"token function"}},[t._v("onClickButton")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("e"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{attrs:{class:"token string"}},[t._v("'clickMe'")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),n("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"分析"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#分析","aria-hidden":"true"}},[this._v("#")]),this._v(" 分析")])},function(){var t=this,s=t.$createElement,n=t._self._c||s;return n("ul",[n("li",[n("p",[t._v("父组件将"),n("code",[t._v("defaultVal")]),t._v("传递给子组建，子组件进入装载阶段,")])]),t._v(" "),n("li",[n("p",[t._v("当父组件点击 "),n("code",[t._v("改变初始值的时候")])]),t._v(" "),n("ul",[n("li",[t._v("父组件进入shouldComponentUpdate阶段")]),t._v(" "),n("li",[t._v("父组件进入render")]),t._v(" "),n("li",[t._v("子组件进入componentReaciveProps")]),t._v(" "),n("li",[t._v("子组件进入shouldComponentUpdate阶段")]),t._v(" "),n("li",[t._v("子组件的render 初始化页面")]),t._v(" "),n("li",[n("code",[t._v("props的值count")]),t._v(" 依赖传递的props 更新了")]),t._v(" "),n("li",[n("code",[t._v("state的值count")]),t._v(" 依赖于自己的state\n"),n("ul",[n("li",[t._v("自己的state 只是在constructor 时接收了props 当作自己的初始值。只会执行一次")])])])])]),t._v(" "),n("li",[n("p",[n("code",[t._v("h.p({}, 'state的值count: ' + this.state.count, ''),")]),t._v(" 依赖自己的state")])]),t._v(" "),n("li",[n("p",[n("code",[t._v("h.p({}, 'props的值count: ' + this.props.count, ''),")]),t._v(" 依赖父组件props")])])])},function(){var t=this,s=t.$createElement,n=t._self._c||s;return n("div",{staticClass:"tip custom-block"},[n("p",{staticClass:"custom-block-title"},[t._v("证明组件的comonentReactiveProps在props不改时也会触发")]),t._v(" "),n("p",[n("strong",[t._v("将子组件的 "),n("code",[t._v("h.p({}, 'props的值count: ' + this.props.count, ''),")]),t._v("注释")])]),t._v(" "),n("ul",[n("li",[t._v("这时子组件只接收props只在"),n("code",[t._v("constructor")]),t._v("时用到了")]),t._v(" "),n("li",[t._v("点击父组件的"),n("code",[t._v("改变初始值")])])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"shouldcomponentupdate-nextprops-nextstate-返回值决定是否渲染页面"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#shouldcomponentupdate-nextprops-nextstate-返回值决定是否渲染页面","aria-hidden":"true"}},[this._v("#")]),this._v(" shouldComponentUpdate(nextProps, nextState) 返回值决定是否渲染页面")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"componentwillupdate-nextprops-nextstate-a-a-react-17-废弃"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#componentwillupdate-nextprops-nextstate-a-a-react-17-废弃","aria-hidden":"true"}},[this._v("#")]),this._v(" componentWillUpdate(nextProps, nextState, a) a ? "),s("code",[this._v("react 17. 废弃")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"componentdidupdate-nextprops-nextstate-会在服务端调用-说明代码有问题"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#componentdidupdate-nextprops-nextstate-会在服务端调用-说明代码有问题","aria-hidden":"true"}},[this._v("#")]),this._v(" componentDidUpdate(nextProps, nextState) 会在服务端调用 说明代码有问题")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"react组件state和props的局限性"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#react组件state和props的局限性","aria-hidden":"true"}},[this._v("#")]),this._v(" React组件state和props的局限性")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"问题-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#问题-2","aria-hidden":"true"}},[this._v("#")]),this._v(" 问题")])},function(){var t=this.$createElement,s=this._self._c||t;return s("ul",[s("li",[this._v("constructor的第二个参数 ？ ``")]),this._v(" "),s("li",[this._v("componentWillUpdate 的第三个参数 ？ "),s("code",[this._v("客户端服务点都调用")])]),this._v(" "),s("li")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"总结"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#总结","aria-hidden":"true"}},[this._v("#")]),this._v(" 总结")])},function(){var t=this,s=t.$createElement,n=t._self._c||s;return n("ul",[n("li",[n("p",[t._v("react 强制刷新页面"),n("code",[t._v("his.forceUpdate();")])])]),t._v(" "),n("li",[n("p",[t._v("https://segmentfault.com/q/1010000011289209")])]),t._v(" "),n("li",[n("p",[t._v("https://segmentfault.com/q/1010000011289209\neventClick")])]),t._v(" "),n("li",[n("p",[t._v("父组件专递事件给子组件，父组建也会进入render - 》子组件")])]),t._v(" "),n("li",[n("p",[t._v("最上层的根组件需要重新render，必定导致其所有子组件都要重新render，")])]),t._v(" "),n("li",[n("p",[t._v("1、执行了render方法不代表会更新dom树，在react当中你使用了setstate更新了state或者改变了传入的props，都会执行render方法，执行了render方法以后，才会生成dom树进行对比，如果dom有差异才会进行构建新的渲染树，更新对应的dom，否则，不会更新。因此，生成虚拟dom树进行对比是在render函数执行了之后进行，而不是执行之前。")])]),t._v(" "),n("li",[n("p",[t._v("2、拆分组件有助于性能优化。组件拆分了，各组件之间的耦合性小了，某个子组件需要更新的时候，牵涉到其他的组件就少，就能减少牵一发而动全身这种情况。")])])])}],!1,null,null,null);e.options.__file="TheSecondChapter.md";s.default=e.exports}}]);